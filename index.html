<!DOCTYPE html>
<!--
  ╔══════════════════════════════════════════════════════════════╗
  ║   بوابتي — Content Portal                                    ║
  ║   Version: 2.0 | Author: Bawabaty Dev Team                  ║
  ║   Stack: HTML5 · CSS3 (Glassmorphism) · Vanilla JS (ES6+)   ║
  ║   Icons: Font Awesome 6 · Fonts: Tajawal (Google Fonts)      ║
  ╚══════════════════════════════════════════════════════════════╝
-->
<html lang="ar" dir="rtl">

<head>
    <!-- ─── Meta & SEO ─────────────────────────────────────────── -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="بوابتي — منصة لمشاركة المحتوى بأسلوب عصري واحترافي">
    <meta name="theme-color" content="#0f172a">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Bawabaty Dev Team">

    <!-- Open Graph (Facebook / WhatsApp / LinkedIn) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="بوابتي — My Portal">
    <meta property="og:description" content="منصة لمشاركة المحتوى بأسلوب عصري واحترافي">
    <meta property="og:locale" content="ar_AR">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="بوابتي — My Portal">
    <meta name="twitter:description" content="منصة لمشاركة المحتوى بأسلوب عصري واحترافي">

    <title>بوابتي — My Portal</title>

    <!-- Favicon placeholder (replace with your actual icon) -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🚪</text></svg>">

    <!-- ─── Stylesheet ─────────────────────────────────────────── -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="auth-style.css">

    <!-- ─── Google Fonts: Tajawal (Arabic-optimized) ─────────── -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap"
        rel="stylesheet">

    <!-- ─── Font Awesome 6 (Icons Library) ────────────────────── -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <!-- ════════════════════════════════════════════════════════════
       DECORATIVE BACKGROUND BLOBS
       Animated gradient orbs for the glassmorphism effect.
       ════════════════════════════════════════════════════════════ -->
    <div class="background-globes" aria-hidden="true">
        <div class="globe globe-1"></div>
        <div class="globe globe-2"></div>
        <div class="globe globe-3"></div>
    </div>

    <!-- ════════════════════════════════════════════════════════════
       APP ROOT CONTAINER
       Houses sidebar + main content in a flex layout.
       ════════════════════════════════════════════════════════════ -->
    <div class="app-container">

        <!-- ── Mobile Sidebar Overlay (click to close) ─────────── -->
        <div id="sidebar-overlay" class="sidebar-overlay" aria-hidden="true"></div>

        <!-- ════════════════════════════════════════════════════════
         SIDEBAR / NAVIGATION
         Sticky side panel with logo, user info, nav links,
         and social media shortcuts.
         ════════════════════════════════════════════════════════ -->
        <!-- Using div+nav rather than aside+role=navigation to avoid duplicate landmark -->
        <div id="sidebar" class="sidebar glass-panel">

            <!-- Close button — mobile only -->
            <button id="sidebar-close-btn" class="sidebar-close-btn" aria-label="إغلاق القائمة">
                <i class="fa-solid fa-xmark"></i>
            </button>

            <!-- Logo & App Name -->
            <div class="logo">
                <i class="fa-solid fa-cube" aria-hidden="true"></i>
                <h1>بوابتي</h1>
            </div>

            <!-- User Profile Box (shown after login) -->
            <div id="user-profile" class="user-profile glass-panel" style="display:none;" role="region"
                aria-label="معلومات المستخدم">
                <div class="user-avatar" aria-hidden="true">U</div>
                <div class="user-info">
                    <h4 id="user-email">user@email.com</h4>
                    <button id="logout-btn" class="logout-btn">
                        <i class="fa-solid fa-right-from-bracket"></i> تسجيل خروج
                    </button>
                </div>
            </div>

            <!-- Guest Controls (shown when browsing anonymously) -->
            <div id="guest-controls" class="guest-controls glass-panel" style="display:none;" role="region"
                aria-label="وضع الزائر">
                <i class="fa-solid fa-user-secret" aria-hidden="true"></i>
                <p>أنت تتصفح كزائر</p>
                <button id="guest-login-btn" class="btn-primary">
                    <i class="fa-solid fa-key"></i> تسجيل الدخول
                </button>
            </div>

            <!-- Primary Navigation Links -->
            <nav class="nav-links" aria-label="التنقل">
                <a href="#" class="active" data-view="feed" aria-current="page">
                    <i class="fa-solid fa-house" aria-hidden="true"></i> الرئيسية
                </a>
                <a href="#" data-view="feed">
                    <i class="fa-solid fa-compass" aria-hidden="true"></i> استكشاف
                </a>
                <a href="#" id="nav-scheduled" data-view="scheduled">
                    <i class="fa-regular fa-calendar-check" aria-hidden="true"></i> المجدولة
                </a>
                <a href="#" data-view="saved">
                    <i class="fa-solid fa-bookmark" aria-hidden="true"></i> المحفوظات
                </a>
            </nav>

            <!-- Sidebar Stats -->
            <div class="sidebar-stats" id="sidebar-stats" aria-label="إحصائيات المحتوى">
                <div class="stat-chip">
                    <span class="stat-num" id="stat-published">0</span>
                    <span class="stat-lbl">منشور</span>
                </div>
                <div class="stat-chip">
                    <span class="stat-num" id="stat-drafts">0</span>
                    <span class="stat-lbl">مسودة</span>
                </div>
                <div class="stat-chip">
                    <span class="stat-num" id="stat-scheduled">0</span>
                    <span class="stat-lbl">مجدول</span>
                </div>
            </div>

            <!-- Social Media Hub -->
            <div class="social-hub">
                <h3>تواصل معي</h3>
                <div class="social-icons" role="list">
                    <a href="#" class="social-link instagram" role="listitem" aria-label="Instagram">
                        <i class="fa-brands fa-instagram"></i>
                    </a>
                    <a href="#" class="social-link tiktok" role="listitem" aria-label="TikTok">
                        <i class="fa-brands fa-tiktok"></i>
                    </a>
                    <a href="#" class="social-link youtube" role="listitem" aria-label="YouTube">
                        <i class="fa-brands fa-youtube"></i>
                    </a>
                    <a href="#" class="social-link twitter" role="listitem" aria-label="X (Twitter)">
                        <i class="fa-brands fa-x-twitter"></i>
                    </a>
                    <a href="#" class="social-link linkedin" role="listitem" aria-label="LinkedIn">
                        <i class="fa-brands fa-linkedin-in"></i>
                    </a>
                    <a href="#" class="social-link snapchat" role="listitem" aria-label="Snapchat">
                        <i class="fa-brands fa-snapchat"></i>
                    </a>
                </div>
            </div>

        </div><!-- /sidebar -->


        <!-- ════════════════════════════════════════════════════════
         MAIN CONTENT AREA
         Holds the top bar header and the scrollable feed grid.
         ════════════════════════════════════════════════════════ -->
        <main class="main-content" role="main">

            <!-- ── Top Bar ─────────────────────────────────────────── -->
            <header class="top-bar glass-panel" role="banner">

                <!-- Hamburger toggle (mobile only) -->
                <button id="hamburger-btn" class="hamburger-btn" aria-label="فتح القائمة" aria-expanded="false">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>

                <!-- Search Input -->
                <div class="search-bar" role="search">
                    <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
                    <input type="search" placeholder="ابحث عن مقالات، صور، ملفات..." aria-label="بحث">
                </div>

                <!-- Action Buttons -->
                <div class="top-bar-actions">
                    <!-- Dark / Light Mode Toggle -->
                    <button id="theme-toggle-btn" class="theme-toggle" title="تبديل الوضع الليلي/النهاري"
                        aria-label="تبديل الثيم">
                        <i class="fa-solid fa-sun icon-light" aria-hidden="true"></i>
                        <i class="fa-solid fa-moon icon-dark" aria-hidden="true"></i>
                    </button>

                    <!-- New Post Button -->
                    <button id="open-upload-modal" class="btn-primary">
                        <i class="fa-solid fa-plus" aria-hidden="true"></i>
                        <span class="btn-label">مشاركة جديدة</span>
                    </button>
                </div>

            </header><!-- /top-bar -->

            <!-- ── Content Feed (populated by JS) ─────────────────── -->
            <div id="feed-container" class="feed-grid" role="feed" aria-label="آخر المنشورات">
                <!-- Skeleton loading cards shown while data loads -->
                <div class="skeleton-card" id="sk1">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-img"></div>
                    <div class="skeleton skeleton-line"></div>
                    <div class="skeleton skeleton-line short"></div>
                    <div class="skeleton skeleton-footer"></div>
                </div>
                <div class="skeleton-card" id="sk2">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-line"></div>
                    <div class="skeleton skeleton-line short"></div>
                    <div class="skeleton skeleton-footer"></div>
                </div>
                <div class="skeleton-card" id="sk3">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-img"></div>
                    <div class="skeleton skeleton-line"></div>
                    <div class="skeleton skeleton-footer"></div>
                </div>
            </div>

        </main><!-- /main-content -->

    </div><!-- /app-container -->

    <!-- ════════════════════════════════════════════════════════════
       SCROLL TO TOP BUTTON
       ════════════════════════════════════════════════════════════ -->
    <button id="scroll-top-btn" aria-label="العودة للأعلى" title="العودة للأعلى">
        <i class="fa-solid fa-chevron-up"></i>
    </button>


    <!-- ════════════════════════════════════════════════════════════
       UPLOAD MODAL — Advanced Post Editor
       Two-column layout:
         • Right column  → Form / Editor / Options
         • Left column   → Live Preview card
       ════════════════════════════════════════════════════════════ -->
    <div id="upload-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="modal-heading">

        <div class="modal-content modal-wide glass-panel">

            <!-- Modal Header -->
            <div class="modal-header">
                <h3 id="modal-heading">
                    <i class="fa-solid fa-pen-nib" aria-hidden="true"></i> مشاركة جديدة
                </h3>
                <button id="close-modal" class="close-btn" aria-label="إغلاق">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <!-- ── Two-Column Layout ─────────────────────────────── -->
            <div class="modal-editor-layout">

                <!-- ══════════════════════════════════════════════════
             EDITOR COLUMN (Right in RTL)
             Contains: title, rich-text editor, drag-drop
             zone, and advanced options panel.
             ══════════════════════════════════════════════════ -->
                <div class="editor-column">
                    <form id="upload-form" novalidate>

                        <!-- 1. Post Title -->
                        <input type="text" id="post-title" placeholder="عنوان المنشور..." required class="title-input"
                            aria-label="عنوان المنشور" maxlength="120">

                        <!-- ── 2. Rich Text Editor (RTE) ──────────────── -->
                        <!-- Toolbar: formatting commands via execCommand -->
                        <div class="rte-toolbar" role="toolbar" aria-label="أدوات التنسيق">

                            <!-- Text Formatting Group -->
                            <button type="button" class="rte-btn" data-cmd="bold" title="عريض (Ctrl+B)"
                                aria-label="عريض">
                                <i class="fa-solid fa-bold"></i>
                            </button>
                            <button type="button" class="rte-btn" data-cmd="italic" title="مائل (Ctrl+I)"
                                aria-label="مائل">
                                <i class="fa-solid fa-italic"></i>
                            </button>
                            <button type="button" class="rte-btn" data-cmd="underline" title="تسطير (Ctrl+U)"
                                aria-label="تسطير">
                                <i class="fa-solid fa-underline"></i>
                            </button>

                            <div class="rte-divider" role="separator"></div>

                            <!-- List Group -->
                            <button type="button" class="rte-btn" data-cmd="insertUnorderedList" title="قائمة نقطية"
                                aria-label="قائمة نقطية">
                                <i class="fa-solid fa-list-ul"></i>
                            </button>
                            <button type="button" class="rte-btn" data-cmd="insertOrderedList" title="قائمة مرقمة"
                                aria-label="قائمة مرقمة">
                                <i class="fa-solid fa-list-ol"></i>
                            </button>

                            <div class="rte-divider" role="separator"></div>

                            <!-- Alignment Group -->
                            <button type="button" class="rte-btn" data-cmd="justifyRight" title="محاذاة يمين"
                                aria-label="محاذاة يمين">
                                <i class="fa-solid fa-align-right"></i>
                            </button>
                            <button type="button" class="rte-btn" data-cmd="justifyCenter" title="توسيط"
                                aria-label="توسيط">
                                <i class="fa-solid fa-align-center"></i>
                            </button>
                            <button type="button" class="rte-btn" data-cmd="justifyLeft" title="محاذاة يسار"
                                aria-label="محاذاة يسار">
                                <i class="fa-solid fa-align-left"></i>
                            </button>

                            <div class="rte-divider" role="separator"></div>

                            <!-- Link & Clear -->
                            <button type="button" class="rte-btn" id="rte-link-btn" title="إضافة رابط"
                                aria-label="إضافة رابط">
                                <i class="fa-solid fa-link"></i>
                            </button>
                            <button type="button" class="rte-btn" data-cmd="removeFormat" title="مسح التنسيق"
                                aria-label="مسح التنسيق">
                                <i class="fa-solid fa-eraser"></i>
                            </button>

                        </div><!-- /rte-toolbar -->

                        <!-- Editable content area (contenteditable div) -->
                        <div id="post-content-editor" class="rte-editor" contenteditable="true" dir="rtl" role="textbox"
                            aria-multiline="true" aria-label="محتوى المنشور"
                            data-placeholder="بماذا تفكر؟ اكتب محتوى منشورك هنا...">
                        </div>

                        <!-- Hidden textarea synced with RTE content (for form submission) -->
                        <textarea id="post-content" hidden aria-hidden="true"></textarea>


                        <!-- ── 3. Drag & Drop File Upload Zone ────────── -->
                        <div id="drop-zone" class="drop-zone" role="button"
                            aria-label="منطقة رفع الملفات — اسحب وأفلت أو انقر للاختيار" tabindex="0">

                            <!-- Default prompt (visible when no file selected) -->
                            <div class="drop-zone-inner">
                                <i class="fa-solid fa-cloud-arrow-up drop-zone-icon" aria-hidden="true"></i>
                                <p class="drop-zone-text">اسحب صورة أو ملفاً هنا</p>
                                <p class="drop-zone-hint">PNG، JPG، PDF، MP4 — حتى 50 MB</p>
                                <div class="drop-zone-actions">
                                    <!-- Image picker trigger — label wraps hidden input (valid HTML) -->
                                    <label class="action-chip" for="image-input" role="button" tabindex="0"
                                        aria-label="اختيار صورة">
                                        <i class="fa-regular fa-image" aria-hidden="true"></i> صورة
                                    </label>
                                    <input type="file" id="image-input" accept="image/*" hidden aria-hidden="true">

                                    <!-- Generic file picker trigger -->
                                    <label class="action-chip" for="file-input" role="button" tabindex="0"
                                        aria-label="اختيار ملف">
                                        <i class="fa-solid fa-paperclip" aria-hidden="true"></i> ملف
                                    </label>
                                    <input type="file" id="file-input" hidden aria-hidden="true">
                                </div>
                            </div>

                            <!-- Media preview area (shown after file selection) -->
                            <div id="media-preview-area" style="display:none; position:relative;">
                                <button type="button" id="clear-media" class="clear-media-btn"
                                    aria-label="إزالة الملف المرفق">
                                    <i class="fa-solid fa-xmark"></i>
                                </button>
                                <!-- Image/file preview injected here by EditorService -->
                                <div id="media-content"></div>
                            </div>

                        </div><!-- /drop-zone -->


                        <!-- ── 4. Advanced Options Toggle ─────────────── -->
                        <div class="advanced-toggle-row">
                            <button type="button" class="action-chip" id="toggle-options-btn" aria-expanded="false"
                                aria-controls="advanced-options">
                                <i class="fa-solid fa-sliders"></i> خيارات متقدمة
                            </button>
                        </div>

                        <!-- Advanced Options Panel (collapsed by default) -->
                        <div id="advanced-options" style="display:none;" role="region" aria-label="الخيارات المتقدمة">

                            <!-- ── 4a. Post Template Chooser ──────────── -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa-solid fa-palette" aria-hidden="true"></i>
                                    قالب المنشور
                                </label>
                                <div class="design-chips" role="radiogroup" aria-label="اختر قالب العرض">
                                    <div class="design-option active" data-style="classic" role="radio"
                                        aria-checked="true" tabindex="0">
                                        <i class="fa-solid fa-newspaper" aria-hidden="true"></i> Classic
                                    </div>
                                    <div class="design-option" data-style="modern" role="radio" aria-checked="false"
                                        tabindex="0">
                                        <i class="fa-solid fa-layer-group" aria-hidden="true"></i> Modern
                                    </div>
                                    <div class="design-option" data-style="neon" role="radio" aria-checked="false"
                                        tabindex="0">
                                        <i class="fa-solid fa-bolt" aria-hidden="true"></i> Neon
                                    </div>
                                    <div class="design-option" data-style="quote" role="radio" aria-checked="false"
                                        tabindex="0">
                                        <i class="fa-solid fa-quote-right" aria-hidden="true"></i> Quote
                                    </div>
                                </div>
                                <!-- Hidden field stores selected template value -->
                                <input type="hidden" id="post-style" value="classic">
                            </div>

                            <!-- ── 4b. Private / Public Toggle ──────────── -->
                            <div class="toggle-row">
                                <span class="toggle-label">
                                    <i class="fa-solid fa-lock" aria-hidden="true"></i>
                                    منشور خاص
                                </span>
                                <label class="toggle-switch" aria-label="تفعيل الخصوصية">
                                    <input type="checkbox" id="post-private" role="switch">
                                    <span class="toggle-track"><span class="toggle-thumb"></span></span>
                                </label>
                            </div>

                            <!-- ── 4c. Publish Time Picker ─────────────── -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa-regular fa-clock" aria-hidden="true"></i>
                                    وقت النشر
                                </label>

                                <!-- Tab-style switcher: Now / Schedule -->
                                <div class="publish-type-tabs" role="tablist">
                                    <button type="button" class="pub-tab active" data-pub="now" role="tab"
                                        aria-selected="true">
                                        <i class="fa-solid fa-bolt" aria-hidden="true"></i> الآن
                                    </button>
                                    <button type="button" class="pub-tab" data-pub="schedule" role="tab"
                                        aria-selected="false">
                                        <i class="fa-regular fa-calendar-check" aria-hidden="true"></i> جدولة
                                    </button>
                                </div>

                                <!-- Schedule Picker (shown when "جدولة" is selected) -->
                                <div id="schedule-picker" class="schedule-picker" style="display:none;" role="tabpanel">
                                    <div class="schedule-picker-inner">
                                        <i class="fa-solid fa-calendar-days picker-icon" aria-hidden="true"></i>
                                        <!-- Native datetime-local (hidden, opened programmatically) -->
                                        <input type="datetime-local" id="schedule-input" class="datetime-input"
                                            aria-label="اختر تاريخ ووقت النشر">
                                        <!-- Human-readable display label -->
                                        <span id="schedule-display" class="schedule-display">
                                            اختر تاريخاً ووقتاً
                                        </span>
                                    </div>
                                </div>

                                <!-- Hidden field storing publish mode: "now" | "schedule" -->
                                <input type="hidden" id="publish-type-select" value="now">
                            </div>

                            <!-- ── 4d. Social Platform Toggles ────────── -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                                    نشر تلقائي على المنصات
                                </label>
                                <div class="social-toggles-grid">

                                    <!-- Instagram -->
                                    <div class="social-toggle-item" data-platform="instagram">
                                        <div class="soc-tog-left">
                                            <i class="fa-brands fa-instagram" aria-hidden="true"
                                                style="color:#E1306C"></i>
                                            <span>Instagram</span>
                                        </div>
                                        <label class="toggle-switch" aria-label="نشر على Instagram">
                                            <input type="checkbox" name="social_platform" value="instagram"
                                                role="switch">
                                            <span class="toggle-track" style="--tog-on:#E1306C">
                                                <span class="toggle-thumb"></span>
                                            </span>
                                        </label>
                                    </div>

                                    <!-- X (Twitter) -->
                                    <div class="social-toggle-item" data-platform="twitter">
                                        <div class="soc-tog-left">
                                            <i class="fa-brands fa-x-twitter" aria-hidden="true"></i>
                                            <span>X (Twitter)</span>
                                        </div>
                                        <label class="toggle-switch" aria-label="نشر على X (Twitter)">
                                            <input type="checkbox" name="social_platform" value="twitter" role="switch">
                                            <span class="toggle-track" style="--tog-on:#1DA1F2">
                                                <span class="toggle-thumb"></span>
                                            </span>
                                        </label>
                                    </div>

                                    <!-- TikTok -->
                                    <div class="social-toggle-item" data-platform="tiktok">
                                        <div class="soc-tog-left">
                                            <i class="fa-brands fa-tiktok" aria-hidden="true"></i>
                                            <span>TikTok</span>
                                        </div>
                                        <label class="toggle-switch" aria-label="نشر على TikTok">
                                            <input type="checkbox" name="social_platform" value="tiktok" role="switch">
                                            <span class="toggle-track" style="--tog-on:#69C9D0">
                                                <span class="toggle-thumb"></span>
                                            </span>
                                        </label>
                                    </div>

                                    <!-- YouTube -->
                                    <div class="social-toggle-item" data-platform="youtube">
                                        <div class="soc-tog-left">
                                            <i class="fa-brands fa-youtube" aria-hidden="true"
                                                style="color:#FF0000"></i>
                                            <span>YouTube</span>
                                        </div>
                                        <label class="toggle-switch" aria-label="نشر على YouTube">
                                            <input type="checkbox" name="social_platform" value="youtube" role="switch">
                                            <span class="toggle-track" style="--tog-on:#FF0000">
                                                <span class="toggle-thumb"></span>
                                            </span>
                                        </label>
                                    </div>

                                    <!-- LinkedIn -->
                                    <div class="social-toggle-item" data-platform="linkedin">
                                        <div class="soc-tog-left">
                                            <i class="fa-brands fa-linkedin-in" aria-hidden="true"
                                                style="color:#0A66C2"></i>
                                            <span>LinkedIn</span>
                                        </div>
                                        <label class="toggle-switch" aria-label="نشر على LinkedIn">
                                            <input type="checkbox" name="social_platform" value="linkedin"
                                                role="switch">
                                            <span class="toggle-track" style="--tog-on:#0A66C2">
                                                <span class="toggle-thumb"></span>
                                            </span>
                                        </label>
                                    </div>

                                </div><!-- /social-toggles-grid -->
                            </div>

                        </div><!-- /advanced-options -->


                        <!-- ── 5. Form Footer: Draft + Publish Buttons ── -->
                        <div class="modal-footer">
                            <!-- Draft saved status indicator (shown after save) -->
                            <div class="draft-status" id="draft-status" style="display:none;" aria-live="polite">
                                <i class="fa-solid fa-circle-check" aria-hidden="true"></i>
                                <span id="draft-status-text">تم حفظ المسودة</span>
                            </div>
                            <!-- Save Draft manually -->
                            <button type="button" class="btn-secondary" id="save-draft-btn">
                                <i class="fa-regular fa-floppy-disk" aria-hidden="true"></i> حفظ مسودة
                            </button>
                            <!-- Publish / Submit -->
                            <button type="submit" class="btn-primary">
                                <i class="fa-solid fa-paper-plane" aria-hidden="true"></i> نشر
                            </button>
                        </div>

                    </form>
                </div><!-- /editor-column -->


                <!-- ══════════════════════════════════════════════════
             PREVIEW COLUMN (Left in RTL)
             Live mirror of the post as the user types.
             Updates in real-time via EditorService.
             ══════════════════════════════════════════════════ -->
                <div class="preview-column" role="complementary" aria-label="معاينة المنشور">

                    <div class="preview-column-header">
                        <i class="fa-solid fa-eye" aria-hidden="true"></i> معاينة المنشور
                    </div>

                    <!-- Live Preview Card — mirrors a published post card -->
                    <article id="post-live-preview" class="post-card classic preview-card"
                        aria-label="معاينة حية للمنشور">
                        <div class="post-header">
                            <div>
                                <b id="preview-title">عنوان المنشور</b>
                            </div>
                            <div class="meta">
                                <span id="preview-date">الآن</span>
                            </div>
                        </div>
                        <div id="preview-body" class="post-text preview-body-text">
                            محتوى المنشور سيظهر هنا...
                        </div>
                        <!-- Media preview mirrored from drop zone -->
                        <div id="preview-media" style="display:none;" aria-hidden="true"></div>
                        <div class="post-footer">
                            <span class="user-badge">
                                <i class="fa-solid fa-user" aria-hidden="true"></i> أنت
                            </span>
                        </div>
                    </article>

                    <p class="preview-hint" aria-hidden="true">يتحدّث المعاينة تلقائياً أثناء الكتابة</p>

                </div><!-- /preview-column -->

            </div><!-- /modal-editor-layout -->

        </div><!-- /modal-content -->
    </div><!-- /upload-modal -->


    <!-- ════════════════════════════════════════════════════════════════════
       🔐 AUTH v4 — PREMIUM 3-VIEW AUTH SYSTEM
       Modern Clean UI - Glassmorphism
    ════════════════════════════════════════════════════════════════════ -->
    <div id="auth-modal" class="auth-overlay" role="dialog" aria-modal="true" aria-labelledby="auth-title">
        <div class="auth-container">
            <button id="auth-close-btn" class="sidebar-close-btn" style="position:absolute; top:1rem; left:1rem; background:none; border:none; color:#fff; font-size:1.2rem; cursor:pointer;">
                <i class="fa-solid fa-xmark"></i>
            </button>

            <!-- Tabs -->
            <div class="auth-tabs" role="tablist">
                <button class="auth-tab active" id="tab-login" onclick="AuthUI.switch('login')">تسجيل الدخول</button>
                <button class="auth-tab" id="tab-signup" onclick="AuthUI.switch('signup')">إنشاء حساب</button>
            </div>

            <div class="auth-forms-wrapper">
                <!-- Login Form -->
                <form id="login-form" class="auth-form active" novalidate>
                    <div class="input-group">
                        <label class="input-label" for="login-email">البريد الإلكتروني</label>
                        <div class="input-wrapper">
                            <i class="fa-solid fa-envelope input-icon"></i>
                            <input type="email" id="login-email" class="input-field" placeholder="name@example.com" required>
                        </div>
                        <div class="validation-msg" id="msg-login-email"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label" for="login-password">كلمة المرور</label>
                        <div class="input-wrapper">
                            <i class="fa-solid fa-lock input-icon"></i>
                            <input type="password" id="login-password" class="input-field" placeholder="••••••••" required>
                            <button type="button" class="toggle-password" onclick="AuthUI.togglePw('login-password')">
                                <i class="fa-regular fa-eye"></i>
                            </button>
                        </div>
                        <div class="validation-msg" id="msg-login-password"></div>
                    </div>

                    <button type="submit" class="submit-btn">دخول</button>
                    
                    <div style="text-align:center; margin-top:1rem;">
                        <button type="button" class="av4-ghost-btn" onclick="AuthService.guestLogin()" style="color:var(--auth-text-muted); background:none; border:none; cursor:pointer;">
                            تصفح كزائر
                        </button>
                    </div>
                </form>

                <!-- Signup Form -->
                <form id="signup-form" class="auth-form" novalidate>
                    <div class="input-group">
                        <label class="input-label" for="signup-email">البريد الإلكتروني</label>
                        <div class="input-wrapper">
                            <i class="fa-solid fa-envelope input-icon"></i>
                            <input type="email" id="signup-email" class="input-field" placeholder="name@example.com" required>
                        </div>
                        <div class="validation-msg" id="msg-signup-email"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label" for="signup-password">كلمة المرور</label>
                        <div class="input-wrapper">
                            <i class="fa-solid fa-lock input-icon"></i>
                            <input type="password" id="signup-password" class="input-field" placeholder="8+ أحرف" required>
                            <button type="button" class="toggle-password" onclick="AuthUI.togglePw('signup-password')">
                                <i class="fa-regular fa-eye"></i>
                            </button>
                        </div>
                        <div class="validation-msg" id="msg-signup-password"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label" for="signup-confirm">تأكيد كلمة المرور</label>
                        <div class="input-wrapper">
                            <i class="fa-solid fa-shield-halved input-icon"></i>
                            <input type="password" id="signup-confirm" class="input-field" placeholder="تطابق كلمة المرور" required>
                        </div>
                        <div class="validation-msg" id="msg-signup-confirm"></div>
                    </div>

                    <button type="submit" class="submit-btn">إنشاء حساب</button>
                </form>
            </div>
        </div>
    </div>



    <!-- ════════════════════════════════════════════════════════════
       LOADING OVERLAY
       Full-screen spinner shown during async operations.
       ════════════════════════════════════════════════════════════ -->
    <div id="loading-overlay" class="modal-overlay hidden" style="z-index:2000;" aria-hidden="true" aria-live="polite"
        aria-label="جارٍ التحميل">
        <div class="spinner" role="status" aria-label="جارٍ التحميل..."></div>
    </div>


    <!-- ════════════════════════════════════════════════════════════
       TOAST NOTIFICATION CONTAINER
       Toasts are dynamically appended here by ToastService.
       ════════════════════════════════════════════════════════════ -->
    <div id="toast-container" role="region" aria-label="الإشعارات" aria-live="polite">
    </div>


    <!-- ════════════════════════════════════════════════════════════
       FIREBASE SDKs (Compat v9 — UMD builds)
       Loaded before firebase-config.js and script.js.
       ════════════════════════════════════════════════════════════ -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>

    <!-- Firebase project configuration (replace with your own keys) -->
    <script src="firebase-config.js"></script>

    <!-- Main application logic -->
    <script src="script.js"></script>

</body>

</html>